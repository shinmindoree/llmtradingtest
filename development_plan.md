# 개발 계획서: 자연어 기반 트레이딩 전략 생성 및 백테스트 어플리케이션

---

#### **1. 프로젝트 개요**
- **목적**: 사용자가 자연어로 트레이딩 전략을 입력하면, 이를 Python 스크립트로 변환하고, 변환된 스크립트를 바이낸스 BTCUSDT Perpetual 선물 데이터(15분봉)에 적용하여 백테스트를 수행하는 어플리케이션 개발.
- **주요 기능**:
  1. 자연어 입력을 Python 코드로 변환 (GPT-4 API 활용).
  2. 변환된 코드를 기반으로 백테스트 수행.
  3. 백테스트 결과를 시각화하여 사용자에게 제공.
  4. Supabase를 활용한 데이터 저장 및 관리.
  5. 프론트엔드에서 사용자 친화적인 UI 제공.

---

#### **2. 개발 방법론**
- **TDD (Test-Driven Development)**:
  - 각 기능별로 테스트 케이스를 먼저 작성하고, 이를 통과하는 코드를 구현.
  - 주요 테스트 항목:
    - 자연어 입력 → Python 코드 변환 정확성.
    - 백테스트 로직의 정확성.
    - 데이터베이스 연동 및 데이터 저장/조회 기능.
    - 프론트엔드와 백엔드 간 API 통신 테스트.
- **마이크로서비스 아키텍처**:
  - 비슷한 기능끼리 묶어서 파일을 구성.
  - 각 주요 기능(전략 변환, 백테스트, 데이터 관리 등)을 독립적으로 개발 및 배포 가능하도록 설계.

---

#### **3. 기술 스택**
- **프론트엔드**: React.js (사용자 친화적이고 간단한 UI 구현).
- **백엔드**: FastAPI (Python 기반, 간단하고 빠른 API 개발 가능).
- **데이터베이스**: Supabase (PostgreSQL 기반, 실시간 데이터 관리 및 인증 기능 제공).
- **AI 모델**: OpenAI GPT-4o API (전략 변환).
- **트레이딩 데이터**: Binance API (BTCUSDT Perpetual 선물 데이터).
- **백테스트 라이브러리**: `backtrader` 또는 `pandas` 기반 커스텀 구현.

---

#### **4. 주요 기능 및 개발 단계**

##### **1단계: 프론트엔드 UI 설계 및 개발**
- **목표**: 사용자 입력 및 결과 확인을 위한 기본 화면 구성.
- **기능**:
  - 자연어 입력 폼.
  - 필수 입력값(자본금, Stop Loss, Take Profit, Order Size 등) 입력 폼.
  - 백테스트 결과 시각화(차트 및 요약 데이터).
- **TDD 테스트 항목**:
  - 입력 폼 유효성 검사.
  - API 호출 및 결과 렌더링 테스트.
- **파일 구조**:
  ```
  /frontend
    ├── components/
    │   ├── InputForm.jsx
    │   ├── ResultChart.jsx
    │   └── StrategyPrompt.jsx
    ├── pages/
    │   ├── HomePage.jsx
    │   └── ResultPage.jsx
    └── App.jsx
  ```

##### **2단계: 자연어 → Python 코드 변환 서비스**
- **목표**: 사용자가 입력한 자연어를 Python 트레이딩 전략 코드로 변환.
- **기능**:
  - OpenAI GPT-4 API를 활용하여 자연어를 Python 코드로 변환.
  - 필수 입력값을 포함한 프롬프트 엔지니어링.
- **TDD 테스트 항목**:
  - 자연어 입력 → Python 코드 변환 정확성.
  - 필수 입력값이 누락된 경우 에러 처리.
- **파일 구조**:
  ```
  /services
    ├── strategy_converter/
    │   ├── converter.py
    │   ├── tests/
    │   │   └── test_converter.py
    └── __init__.py
  ```

##### **3단계: 백테스트 서비스**
- **목표**: 변환된 Python 코드를 Binance 데이터에 적용하여 백테스트 수행.
- **기능**:
  - Binance API를 통해 15분봉 데이터 수집.
  - 변환된 Python 코드 실행 및 결과 계산.
  - 백테스트 결과 저장 및 반환.
- **TDD 테스트 항목**:
  - 데이터 수집 정확성.
  - 백테스트 로직의 정확성.
  - 결과 저장 및 반환 테스트.
- **파일 구조**:
  ```
  /services
    ├── backtester/
    │   ├── backtest.py
    │   ├── data_fetcher.py
    │   ├── tests/
    │   │   ├── test_backtest.py
    │   │   └── test_data_fetcher.py
    └── __init__.py
  ```

##### **4단계: 데이터베이스 연동**
- **목표**: Supabase를 활용하여 사용자 데이터 및 백테스트 결과 저장.
- **기능**:
  - 사용자 입력값 및 백테스트 결과 저장.
  - 저장된 데이터 조회 및 삭제 기능.
- **TDD 테스트 항목**:
  - 데이터 저장 및 조회 테스트.
  - 데이터 삭제 테스트.
- **파일 구조**:
  ```
  /services
    ├── database/
    │   ├── db_manager.py
    │   ├── tests/
    │   │   └── test_db_manager.py
    └── __init__.py
  ```

##### **5단계: 통합 및 배포**
- **목표**: 프론트엔드, 백엔드, 데이터베이스를 통합하여 완전한 어플리케이션 배포.
- **기능**:
  - 프론트엔드와 백엔드 간 API 통신.
  - Docker를 활용한 배포 환경 구성.
- **TDD 테스트 항목**:
  - API 통신 테스트.
  - 전체 시스템 통합 테스트.
- **파일 구조**:
  ```
  /deployment
    ├── docker-compose.yml
    ├── Dockerfile
    └── README.md
  ```

---

#### **5. 프롬프트 엔지니어링**
- **목표**: 자연어 입력의 자유도를 제한하고 필수 입력값을 포함하도록 유도.
- **예시 프롬프트**:
  ```
  사용자가 입력한 전략: "BTC 가격이 5% 상승하면 매수하고, 2% 하락하면 매도."
  변환된 코드:
  - 자본금: $10,000
  - Stop Loss: 2%
  - Take Profit: 5%
  - Order Size: 1 BTC
  ```

---

#### **6. 개발 일정**
- **1주차**: 프론트엔드 UI 설계 및 기본 화면 개발.
- **2주차**: 자연어 → Python 코드 변환 서비스 개발.
- **3주차**: 백테스트 서비스 개발.
- **4주차**: 데이터베이스 연동 및 통합 테스트.
- **5주차**: 배포 및 사용자 피드백 반영.

---

#### **7. 기대 결과**
- 사용자는 간단한 UI를 통해 자연어로 트레이딩 전략을 입력하고, 백테스트 결과를 시각적으로 확인 가능.
- 확장 가능성을 고려한 마이크로서비스 아키텍처로 유지보수 용이.
- TDD를 통해 안정적이고 신뢰성 높은 어플리케이션 제공.

---

#### **8. GitHub 연동 및 버전 관리**
- **목표**: 기능 추가 및 개발 진행 상황을 GitHub에 저장하여 버전 관리 및 협업 효율성 증대.
- **방법**:
  - 각 기능 개발 완료 시 GitHub에 커밋 및 푸시.
  - 주요 브랜치 전략:
    - `main`: 안정적인 배포 버전.
    - `dev`: 개발 중인 기능 통합 브랜치.
    - 기능별 브랜치: `feature/<기능명>` 형식으로 생성.
  - Pull Request(PR)를 통해 코드 리뷰 및 병합 진행.
- **TDD와 연계**:
  - 테스트 통과 후에만 커밋 및 푸시.
  - CI/CD 파이프라인을 통해 자동화된 테스트 및 배포 설정 가능.
- **예시 커밋 메시지 규칙**:
  - `[Feature] 자연어 입력 폼 개발 완료`
  - `[Fix] 백테스트 로직 버그 수정`
  - `[Docs] 개발 계획서 업데이트`

--- 